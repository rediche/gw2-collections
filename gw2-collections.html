<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../paper-tabs/paper-tabs.html">
<link rel="import" href="../iron-pages/iron-pages.html">
<link rel="import" href="../gw2api-items/gw2api-items.html">
<!--<link rel="import" href="../polymer/lib/elements/dom-if.html">-->
<link rel="import" href="../polymer/lib/elements/dom-repeat.html">

<link rel="import" href="./gw2-collections-data.html">

<!--
`gw2-collections`
Generate a paper styled GW2 Collections interface to get an easy overview of prices etc.

@demo demo/index.html
-->

<dom-module id="gw2-collections">
  <template>
    <style>
      :host {
        display: block;
        box-shadow: 0 1px 3px rgba(0,0,0,0.12), 
                    0 1px 2px rgba(0,0,0,0.24);
      }

      paper-tabs {
        --paper-tabs-selection-bar-color: #00695C;

        background-color: var(--gw2-collections-background-color, #80CBC4);
        color: var(--gw2-collections-color, #00695C);
        font-family: var(--gw2-collections-font-family, sans-serif);
      }

      paper-tab {
        text-transform: uppercase;
      }

      paper-tab.iron-selected {
        font-weight: 700;
      }

      paper-tab img {
        height: 32px;
        width: 32px;
        margin-right: 8px;
      }

      .content {
        padding: 1rem;
        font-family: var(--gw2-collections-font-family, sans-serif)
      }
    </style>
    <gw2-collections-data data="{{ data }}"></gw2-collections-data>
    <!--<gw2api-items auto ids="14885" response="{{ itemData }}"></gw2api-items>-->

    <paper-tabs selected="{{ selectedTab }}">
      <template is="dom-repeat" items="[[ data ]]" as="type">
        <paper-tab>
          <img src="[[ importPath ]]/images/[[ type.icon ]]" alt="[[ type.name ]] Collections">
          [[ type.name ]]
        </paper-tab>
      </template>
    </paper-tabs>

    <div class="content">
      <iron-pages selected="{{ selectedTab }}">
        <template is="dom-repeat" items="[[ data ]]" as="type">
          <div>
            <h1>[[ type.name ]] collections</h1>
            Collections in this type:
            <ul>
              <template is="dom-repeat" items="[[ type.collections ]]" as="collection">
                <li>[[ collection.name ]]
                  <ul>
                    <gw2api-items auto ids="[[ _convertToString(collection.item_ids) ]]" response="{{ collection.items }}"></gw2api-items>
                    <template is="dom-repeat" items="[[ collection.items ]]" as="item">
                      <li>[[ item.name ]]</li>
                    </template>
                  </ul>
                </li>
              </template>
            </ul>
          </div>
        </template>
      </iron-pages>
    </div>
  </template>

  <script>
    /** @polymerElement */
    class Gw2Collections extends Polymer.Element {
      static get is() { return 'gw2-collections'; }

      static get properties() {
        return {
          selectedTab: {
            type: Number,
            value: '0'
          },

          data: {
            type: Object
          },
          
          itemData: {
            type: Object,
            observer: '_itemDataChanged'
          }
        };
      }

      _itemDataChanged(itemData) {
        console.log("ItemData", itemData);
      }

      _convertToString(input) {
        console.log("Input", input);
        return String(input);
      }
    }

    window.customElements.define(Gw2Collections.is, Gw2Collections);
  </script>
</dom-module>
